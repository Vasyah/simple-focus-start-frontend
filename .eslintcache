[{"C:\\Users\\Савва\\Desktop\\prog\\react\\simple\\simple-frontend\\src\\index.js":"1","C:\\Users\\Савва\\Desktop\\prog\\react\\simple\\simple-frontend\\src\\App.js":"2","C:\\Users\\Савва\\Desktop\\prog\\react\\simple\\simple-frontend\\src\\contexts\\AuthContext.js":"3","C:\\Users\\Савва\\Desktop\\prog\\react\\simple\\simple-frontend\\src\\components\\NewsPage\\NewsPage.js":"4","C:\\Users\\Савва\\Desktop\\prog\\react\\simple\\simple-frontend\\src\\components\\SignupPage\\SignupPage.js":"5","C:\\Users\\Савва\\Desktop\\prog\\react\\simple\\simple-frontend\\src\\components\\LoginPage\\LoginPage.js":"6","C:\\Users\\Савва\\Desktop\\prog\\react\\simple\\simple-frontend\\src\\components\\UpdateProfile\\UpdateProfilePage.js":"7","C:\\Users\\Савва\\Desktop\\prog\\react\\simple\\simple-frontend\\src\\components\\ForgotPasswordPage\\ForgotPasswordPage.js":"8","C:\\Users\\Савва\\Desktop\\prog\\react\\simple\\simple-frontend\\src\\components\\VideoChatPage\\VideoChatPage.js":"9","C:\\Users\\Савва\\Desktop\\prog\\react\\simple\\simple-frontend\\src\\components\\Header\\Header.js":"10","C:\\Users\\Савва\\Desktop\\prog\\react\\simple\\simple-frontend\\src\\components\\PrivateRoute\\PrivateRoute.js":"11","C:\\Users\\Савва\\Desktop\\prog\\react\\simple\\simple-frontend\\src\\firebase.js":"12","C:\\Users\\Савва\\Desktop\\prog\\react\\simple\\simple-frontend\\src\\components\\Alert\\Alert.js":"13","C:\\Users\\Савва\\Desktop\\prog\\react\\simple\\simple-frontend\\src\\hooks\\useValidatePassword.js":"14","C:\\Users\\Савва\\Desktop\\prog\\react\\simple\\simple-frontend\\src\\hooks\\useLogin.js":"15","C:\\Users\\Савва\\Desktop\\prog\\react\\simple\\simple-frontend\\src\\hooks\\useValidateEmail.js":"16","C:\\Users\\Савва\\Desktop\\prog\\react\\simple\\simple-frontend\\src\\hooks\\useSignup.js":"17","C:\\Users\\Савва\\Desktop\\prog\\react\\simple\\simple-frontend\\src\\hooks\\useUpdateProfile.js":"18","C:\\Users\\Савва\\Desktop\\prog\\react\\simple\\simple-frontend\\src\\hooks\\useForgotPassword.js":"19","C:\\Users\\Савва\\Desktop\\prog\\react\\simple\\simple-frontend\\src\\components\\Users\\Users.js":"20"},{"size":220,"mtime":1609759085619,"results":"21","hashOfConfig":"22"},{"size":1379,"mtime":1610722241367,"results":"23","hashOfConfig":"22"},{"size":2974,"mtime":1610814813050,"results":"24","hashOfConfig":"22"},{"size":275,"mtime":1610299701467,"results":"25","hashOfConfig":"22"},{"size":4235,"mtime":1610814345018,"results":"26","hashOfConfig":"22"},{"size":3192,"mtime":1610046500879,"results":"27","hashOfConfig":"22"},{"size":3920,"mtime":1610524400404,"results":"28","hashOfConfig":"22"},{"size":2719,"mtime":1610046500787,"results":"29","hashOfConfig":"22"},{"size":4813,"mtime":1610779778620,"results":"30","hashOfConfig":"22"},{"size":3030,"mtime":1610814087814,"results":"31","hashOfConfig":"22"},{"size":470,"mtime":1609957852918,"results":"32","hashOfConfig":"22"},{"size":576,"mtime":1610813206689,"results":"33","hashOfConfig":"22"},{"size":388,"mtime":1609957114998,"results":"34","hashOfConfig":"22"},{"size":992,"mtime":1610045519359,"results":"35","hashOfConfig":"22"},{"size":1006,"mtime":1610045480818,"results":"36","hashOfConfig":"22"},{"size":794,"mtime":1610045509732,"results":"37","hashOfConfig":"22"},{"size":1063,"mtime":1610814591348,"results":"38","hashOfConfig":"22"},{"size":1255,"mtime":1610045493394,"results":"39","hashOfConfig":"22"},{"size":1134,"mtime":1610045456411,"results":"40","hashOfConfig":"22"},{"size":130,"mtime":1610721071930,"results":"41","hashOfConfig":"22"},{"filePath":"42","messages":"43","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},"ntt3t2",{"filePath":"45","messages":"46","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"47","messages":"48","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"49","messages":"50","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"51","messages":"52","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"53","messages":"54","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"55","messages":"56","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"57","messages":"58","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"59","messages":"60","errorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"61","usedDeprecatedRules":"44"},{"filePath":"62","messages":"63","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"64","messages":"65","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"66","messages":"67","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"68","messages":"69","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"70","messages":"71","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"72","messages":"73","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"74","messages":"75","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"76","messages":"77","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"78","messages":"79","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"80","messages":"81","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"82","messages":"83","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},"C:\\Users\\Савва\\Desktop\\prog\\react\\simple\\simple-frontend\\src\\index.js",[],["84","85"],"C:\\Users\\Савва\\Desktop\\prog\\react\\simple\\simple-frontend\\src\\App.js",[],"C:\\Users\\Савва\\Desktop\\prog\\react\\simple\\simple-frontend\\src\\contexts\\AuthContext.js",["86"],"C:\\Users\\Савва\\Desktop\\prog\\react\\simple\\simple-frontend\\src\\components\\NewsPage\\NewsPage.js",[],"C:\\Users\\Савва\\Desktop\\prog\\react\\simple\\simple-frontend\\src\\components\\SignupPage\\SignupPage.js",[],"C:\\Users\\Савва\\Desktop\\prog\\react\\simple\\simple-frontend\\src\\components\\LoginPage\\LoginPage.js",[],"C:\\Users\\Савва\\Desktop\\prog\\react\\simple\\simple-frontend\\src\\components\\UpdateProfile\\UpdateProfilePage.js",[],"C:\\Users\\Савва\\Desktop\\prog\\react\\simple\\simple-frontend\\src\\components\\ForgotPasswordPage\\ForgotPasswordPage.js",[],"C:\\Users\\Савва\\Desktop\\prog\\react\\simple\\simple-frontend\\src\\components\\VideoChatPage\\VideoChatPage.js",["87","88","89"],"import React, { useEffect, useState, useRef } from 'react';\r\nimport io from \"socket.io-client\";\r\nimport Peer from \"simple-peer\";\r\nimport './video-chat-page.scss';\r\nimport { useAuth } from \"../../contexts/AuthContext\";\r\n\r\nconst VideoChatPage = () => {\r\n  // ref\r\n  const userVideo = useRef();\r\n  const partnerVideo = useRef();\r\n  const socket = useRef();\r\n  // state\r\n  const [ yourID, setYourID ] = useState(\"\");\r\n  const [ users, setUsers ] = useState({});\r\n  const [ stream, setStream ] = useState();\r\n  const [ receivingCall, setReceivingCall ] = useState(false);\r\n  const [ caller, setCaller ] = useState(\"\");\r\n  const [ callerSignal, setCallerSignal ] = useState();\r\n  const [ callAccepted, setCallAccepted ] = useState(false);\r\n  // other\r\n  const { currentUser } = useAuth();\r\n\r\n  useEffect(() => {\r\n    startVideo();\r\n  }, []);\r\n\r\n  const stopVideo = () => {\r\n    if (userVideo.current) {\r\n      let tracks = userVideo.current.srcObject.getTracks();\r\n      tracks.forEach(function (track) {\r\n        track.stop();\r\n      });\r\n      userVideo.current.srcObject = null;\r\n    }\r\n  }\r\n\r\n  const stopCall = () => {\r\n    if (userVideo.current && partnerVideo.current) {\r\n      let videos = [];\r\n      videos.push(partnerVideo.current.srcObject.getTracks(), userVideo.current.srcObject.getTracks());\r\n      videos.forEach(tracks => {\r\n        tracks.forEach(function (track) {\r\n          track.stop();\r\n        });\r\n      })\r\n      userVideo.current.srcObject = null;\r\n      partnerVideo.current.srcObject = null;\r\n    }\r\n  }\r\n\r\n  const startVideo = () => {\r\n    if (currentUser.id) {\r\n      socket.current = io.connect(\"/\");\r\n      console.log(1)\r\n      navigator.mediaDevices.getUserMedia({ video: true, audio: true }).then(stream => {\r\n        setStream(stream);\r\n        if (userVideo.current) {\r\n          userVideo.current.srcObject = stream;\r\n        }\r\n      })\r\n\r\n      // socket.current.on(\"yourID\", (id) => {\r\n      //   setYourID(id);\r\n      // })\r\n      // socket.current.on(\"allUsers\", (users) => {\r\n      //   setUsers(users);\r\n      // })\r\n\r\n      socket.current.emit(\"yourID\", currentUser.id);\r\n      socket.current.emit(\"allUsers\", currentUser.id);\r\n\r\n      socket.current.on(\"hey\", (data) => {\r\n        setReceivingCall(true);\r\n        setCaller(data.from);\r\n        setCallerSignal(data.signal);\r\n      })\r\n    }\r\n  }\r\n\r\n  const callPeer = id => {\r\n    const peer = new Peer({\r\n      initiator: true,\r\n      trickle: false,\r\n      stream: stream,\r\n    });\r\n\r\n    peer.on('signal', data => {\r\n      socket.emit('callUser', {\r\n        userToCall: id,\r\n        signalData: data,\r\n        from: currentUser.id,\r\n      })\r\n    })\r\n\r\n    peer.on(\"stream\", stream => {\r\n      if (partnerVideo.current) {\r\n        partnerVideo.current.srcObject = stream;\r\n      }\r\n    });\r\n\r\n    socket.current.on(\"callAccepted\", signal => {\r\n      setCallAccepted(true);\r\n      peer.signal(signal);\r\n    })\r\n\r\n  }\r\n\r\n  const acceptCall = () => {\r\n    setCallAccepted(true);\r\n    const peer = new Peer({\r\n      initiator: false,\r\n      trickle: false,\r\n      stream: stream,\r\n    });\r\n\r\n    peer.on('signal', data => {\r\n      socket.current.emit('acceptCall', {\r\n        signal: data,\r\n        to: caller\r\n      })\r\n    })\r\n\r\n    peer.on(\"stream\", stream => {\r\n      partnerVideo.current.srcObject = stream;\r\n    });\r\n\r\n    peer.signal(callerSignal);\r\n  }\r\n\r\n  const log = () => {\r\n    console.log('partnerVideo', partnerVideo);\r\n    console.log('currentUser', currentUser);\r\n  }\r\n\r\n  let UserVideo;\r\n  if (stream) {\r\n    UserVideo = (\r\n      <video playsInline muted ref={userVideo} autoPlay/>\r\n    );\r\n  }\r\n\r\n  let PartnerVideo;\r\n  if (callAccepted) {\r\n    PartnerVideo = (\r\n      <video playsInline ref={partnerVideo} autoPlay/>\r\n    );\r\n  }\r\n\r\n  let incomingCall;\r\n  if (receivingCall) {\r\n    incomingCall = (\r\n      <div>\r\n        <h1>{caller} is calling you</h1>\r\n        <button onClick={acceptCall}>Accept</button>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <div className={'videochat-wrapper container'}>\r\n      <div className={'videochat'}>\r\n        <div>\r\n          {UserVideo}\r\n          {PartnerVideo}\r\n        </div>\r\n        <div>\r\n          {Object.keys(users).map(key => {\r\n            if (key === yourID) {\r\n              console.log(key)\r\n              return null;\r\n            }\r\n            return (\r\n              <button key={yourID} onClick={() => callPeer(key)}>Call {key}</button>\r\n            );\r\n          })}\r\n          <button onClick={stopVideo}>stop video</button>\r\n          <button onClick={startVideo}>start video</button>\r\n          <button onClick={stopCall}>stop call</button>\r\n          <button onClick={log}>log something</button>\r\n        </div>\r\n        <div>\r\n          {incomingCall}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default VideoChatPage;\r\n","C:\\Users\\Савва\\Desktop\\prog\\react\\simple\\simple-frontend\\src\\components\\Header\\Header.js",[],"C:\\Users\\Савва\\Desktop\\prog\\react\\simple\\simple-frontend\\src\\components\\PrivateRoute\\PrivateRoute.js",[],"C:\\Users\\Савва\\Desktop\\prog\\react\\simple\\simple-frontend\\src\\firebase.js",[],"C:\\Users\\Савва\\Desktop\\prog\\react\\simple\\simple-frontend\\src\\components\\Alert\\Alert.js",[],"C:\\Users\\Савва\\Desktop\\prog\\react\\simple\\simple-frontend\\src\\hooks\\useValidatePassword.js",[],"C:\\Users\\Савва\\Desktop\\prog\\react\\simple\\simple-frontend\\src\\hooks\\useLogin.js",[],"C:\\Users\\Савва\\Desktop\\prog\\react\\simple\\simple-frontend\\src\\hooks\\useValidateEmail.js",[],"C:\\Users\\Савва\\Desktop\\prog\\react\\simple\\simple-frontend\\src\\hooks\\useSignup.js",[],"C:\\Users\\Савва\\Desktop\\prog\\react\\simple\\simple-frontend\\src\\hooks\\useUpdateProfile.js",[],"C:\\Users\\Савва\\Desktop\\prog\\react\\simple\\simple-frontend\\src\\hooks\\useForgotPassword.js",[],"C:\\Users\\Савва\\Desktop\\prog\\react\\simple\\simple-frontend\\src\\components\\Users\\Users.js",[],{"ruleId":"90","replacedBy":"91"},{"ruleId":"92","replacedBy":"93"},{"ruleId":"94","severity":1,"message":"95","line":38,"column":9,"nodeType":"96","messageId":"97","endLine":38,"endColumn":17},{"ruleId":"94","severity":1,"message":"98","line":13,"column":19,"nodeType":"96","messageId":"97","endLine":13,"endColumn":28},{"ruleId":"94","severity":1,"message":"99","line":14,"column":18,"nodeType":"96","messageId":"97","endLine":14,"endColumn":26},{"ruleId":"100","severity":1,"message":"101","line":25,"column":6,"nodeType":"102","endLine":25,"endColumn":8,"suggestions":"103"},"no-native-reassign",["104"],"no-negated-in-lhs",["105"],"no-unused-vars","'getUsers' is assigned a value but never used.","Identifier","unusedVar","'setYourID' is assigned a value but never used.","'setUsers' is assigned a value but never used.","react-hooks/exhaustive-deps","React Hook useEffect has a missing dependency: 'startVideo'. Either include it or remove the dependency array.","ArrayExpression",["106"],"no-global-assign","no-unsafe-negation",{"desc":"107","fix":"108"},"Update the dependencies array to be: [startVideo]",{"range":"109","text":"110"},[831,833],"[startVideo]"]